var error_messages = `<%= j render "admins/shared/form_errors_messages" %>`;

function refreshErrorMessages() {
  var element = document.getElementById('error_messages')
  element.innerHTML = "";
}

function addErrorMessages(html) {
  document.querySelector(".button").blur();
  var element = document.getElementById('error_messages')
  element.innerHTML = ""
  element.insertAdjacentHTML('beforeend', html);
}

function addSector() {
  var new_sector =
    `<tr data-sector-id="<%= @sector.id %>" id="<%= dom_id(@sector)%>">
      <td><%= @sector.position %></td>
      <td><%= @sector.name %></td>
      <td><%= @sector.city %></td>
      <% if @sector.persisted? %>
        <td>
          <%= link_to "Supprimer", admins_sector_path(@sector), method: :delete, remote: true %>
          <%= link_to "Voir", admins_sector_path(@sector) %>
          <%= link_to "Editer", edit_admins_sector_path(@sector) %>
        </td>
      <% end %>
    </tr>`;
  document.getElementById('sectors').insertAdjacentHTML('beforeend', new_sector)
  document.querySelector(".button").blur();
}

function refreshForm() {
  document.getElementById("name").value = "";
  document.getElementById("city").value = "";
  document.getElementById("illustration").value = "";
  document.getElementById("description").value = "";
}

<% if @sector.errors.any? %>
  addErrorMessages(error_messages);
<% else %>
  refreshErrorMessages();
  addSector();
  refreshForm();
<% end %>
